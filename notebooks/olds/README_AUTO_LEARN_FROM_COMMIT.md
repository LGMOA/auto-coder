# AutoLearnFromCommit 使用指南

本文档介绍了如何使用 `demo_auto_learn_from_commit.py` 脚本从Git提交历史中学习代码变更模式。

## 功能概述

`AutoLearnFromCommit` 是一个能够分析Git代码提交历史，并利用大型语言模型(LLM)从中学习通用模式的工具。它可以帮助开发者:

1. 自动分析最近的代码提交
2. 提取代码变更的通用模式和最佳实践
3. 总结代码变更的目的和实现方法
4. 为类似需求提供参考和建议

## 前提条件

在运行演示脚本之前，确保您的环境满足以下条件：

1. 已安装Python 3.7+
2. 已安装必要的依赖包(byzerllm, rich, pyyaml, gitpython等)
3. 在有效的Git仓库中运行
4. 有actions目录，包含代码提交的YAML记录

## 使用方法

### 基本用法

```bash
cd <project_root_directory>
python notebooks/demo_auto_learn_from_commit.py
```

### 输出说明

脚本运行时会展示以下信息：

1. **环境设置**：显示源代码目录、LLM模型和产品模式
2. **最新提交信息**：展示最新代码提交的查询、使用的模型等信息
3. **学习过程**：从提交历史中学习代码变更模式
4. **学习结果**：展示学习结果和摘要

## 演示结果示例

脚本成功运行后，将会显示类似下面的输出：

```
┏━━━━━━━━━━━━━━━━━━━━━━━━┓
┃   AutoLearnFromCommit演示   ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━┛

┏━━━━━━━━━━━━━━━━┓
┃   设置演示环境   ┃
┗━━━━━━━━━━━━━━━━┛
源代码目录: /path/to/your/project
LLM模型: v3_chat
产品模式: lite

┏━━━━━━━━━━━━━━━━━━━━┓
┃   获取最新的提交信息   ┃
┗━━━━━━━━━━━━━━━━━━━━┛
最新提交 [000000001920_chat_action.yml]
┏━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ 属性     ┃ 值                                                                                 ┃
┡━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ query   │ 优化RAG索引构建和缓存查询性能，减少默认工作线程数并重构缓存查询逻辑以支持多查询并发...    │
│ model   │ v3_chat                                                                            │
│ urls    │ []                                                                                │
└─────────┴────────────────────────────────────────────────────────────────────────────────────┘

... [其他输出] ...

┏━━━━━━━━━━━━┓
┃   学习结果   ┃
┗━━━━━━━━━━━━┛
[学习结果内容...]

结果摘要
# 代码变更模式总结

1. 优化多线程处理：将默认工作线程数从10降低到5，避免资源过度占用
2. 重构方法支持并发：将单一功能方法拆分为支持并发处理的多个子方法
3. 增强错误处理：添加更完善的异常捕获和日志记录

... [更多摘要内容] ...

┏━━━━━━━━━━┓
┃   演示结束   ┃
┗━━━━━━━━━━┛
```

## 自定义配置

如需自定义配置，可以修改脚本中的 `setup_demo_environment` 函数来设置：

1. 源代码目录
2. LLM模型
3. 产品模式
4. actions目录位置

## 故障排除

如果遇到问题，请检查：

1. 是否在Git仓库根目录运行脚本
2. actions目录是否存在且包含YAML文件
3. 是否有有效的Git提交历史
4. LLM服务是否可用

## 相关资源

- [AutoCoder项目文档](https://github.com/allwefantasy/auto-coder)
- [ByzerLLM文档](https://github.com/allwefantasy/byzer-llm) 