# 035-AutoCoder_auto_merge Explanation

By using auto_merge, users can control three things:

1. Whether to automatically merge into existing source code
2. The format of generating/modifying code
3. The way of merging generated modified code

auto_merge accepts two types of parameters:

1. bool type.
2. String type. Optional values are wholefile, diff, strict_diff

If set to true, it is equivalent to wholefile.

Let's explain these three modes in detail.

## wholefile

In this mode, AutoCoder will require the large model to generate the modified complete code, and when merging, the generated code will be directly replaced in the source code.
This mode is very suitable for new files and files with a large number of modifications. The disadvantage is that even for small modifications, it requires a large number of tokens to be consumed, and most models find it difficult to output the modified complete code almost identically.

## diff

This is a relaxed diff mode, where AutoCoder requires the large model to directly generate the diff format, but this diff format does not require the large model to generate line numbers, only the format @@ *** @@ needs to be generated.
Then, by matching characters, the points of modification are found and merged. This mode has low requirements for the model and generally works well, but in some special cases, merging errors may occur.

The biggest value of diff is that it can reduce the token generation volume by hundreds of times and greatly improve the generation speed. In the future, as you write text, you can quickly see the modified effect coming soon.

## strict_diff

This is a strict diff mode, where AutoCoder sends the source file with line numbers to the large model and requires the large model to directly generate the unified diff format. This diff format needs to generate @@ -7,10 +7,10 @@ line numbers, and then use the patch tool for merging. This mode has the highest requirements for the model, but as long as the diff generated by the model is correct, it will definitely merge correctly.

## Experience of Use

Currently, it is recommended to use the wholefile and diff modes. Programmers need to make a judgment. If there will be many file modifications, but each file modification is not significant, then use the diff mode. If the modifications are significant, then use the wholefile mode.

## Combination Parameters

enable_multi_round_generate can be used in conjunction with auto_merge to achieve multi-round generation by file (generating only one file at a time), and then unify the merging effect. However, it also requires higher model requirements. In general, the following combinations are recommended:

1. diff + enable_multi_round_generate=false
2. wholefile + enable_multi_round_generate=true